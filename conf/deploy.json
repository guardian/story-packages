{
    "defaultStacks": ["cms-fronts"],
    "packages": {
        "story-packages": {
            "type": "autoscaling",
            "data": {
                "port": 9000,
                "bucket": "story-packages-dist",
                "publicReadAcl": false
            }
        },
        "static-story-packages": {
            "type": "aws-s3",
            "data": {
                "bucket": "cms-fronts-static-assets",
                "cacheControl": [
                    {
                        "pattern": ".*\\.js$",
                        "value": "public, max-age=315360000"
                    },
                    {
                        "pattern": ".*",
                        "value": "public, max-age=60"
                    }
                ],
                "mimeTypes": {
                    "js": "application/javascript",
                    "map": "text/plain",
                    "json": "application/json"
                },
                "prefixPackage": true,
                "prefixStack": false,
                "prefixStage": true,
                "publicReadAcl": true
            }
        },
        "machine-images": {
            "type": "ami-cloudformation-parameter",
            "data": {
                "amiTags": {
                    "Recipe": "ubuntu-wily-java8",
                    "AmigoStage": "PROD"
                },
                "amiParameter": "MachineImageID",
                "appendStageToCloudFormationStackName": true,
                "cloudFormationStackName": "story-packages",
                "prependStackToCloudFormationStackName": false
            }
        }
    },
    "recipes": {
        "default": {
            "depends" : ["artifactUpload", "amiUpdate", "staticUpload", "deploy"]
        },
        "deploy": {
            "actionsBeforeApp": ["story-packages.deploy"]
        },
        "artifactUpload": {
            "actionsBeforeApp": ["story-packages.uploadArtifacts"]
        },
        "staticUpload": {
            "actionsBeforeApp": ["static-story-packages.uploadStaticFiles"]
        },
        "amiUpdate": {
            "actionsBeforeApp": ["machine-images.update"]
        }
    }
}
